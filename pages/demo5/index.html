<!DOCTYPE html>
<html lang="en">

<head>
</head>

<body>
  <script type="text/javascript">
    var ctx, analyser, frequencies, getByteFrequencyDataAverage, elVolume, draw;
    window.AudioContext = window.AudioContext || window.webkitAudioContext;
    ctx = new AudioContext();
    analyser = ctx.createAnalyser();
    frequencies = new Uint8Array(analyser.frequencyBinCount);
    navigator.mediaDevices.getUserMedia({
        audio: true
      })
      .then(function(stream) {
        window.hackForMozzila = stream;
        ctx.createMediaStreamSource(stream)
          .connect(analyser);
      })
      .catch(function(err) {
        console.log(err.message);
      });
    (draw = function() {
      analyser.getByteFrequencyData(frequencies);
      console.log(frequencies);
      requestAnimationFrame(draw);
    })();
  </script>
</body>

</html>
